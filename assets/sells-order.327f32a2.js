import{aZ as M,bg as R,U as _,ad as T,o as V,W as C,w as t,a as e,e as p,i as a,a0 as b,bE as P,$ as g,c as I,F as S,a4 as N,bh as $,bi as W,a3 as L,b as f,t as x,aY as E,a$ as H,b3 as X,b4 as Z,g as j,X as G,bl as w,k,Y as q,bC as J,_ as K,l as O,T as B,as as Q,az as h,m as Y}from"./index.18d9e5c6.js";import{u as D}from"./sellsOrders.7cc85978.js";import{V as A}from"./VAutocomplete.9b8c2bfa.js";import{h as ee}from"./moment.9709ab41.js";import{V as z,a as le,b as te,c as ae}from"./VWindowItem.6db79783.js";import"./report.64f3464d.js";import"./VSelect.3f8543e3.js";import"./VCheckboxBtn.ce0f164e.js";const re={__name:"ItemInput",setup(U){const l=D(),i=M();R(l);const r=_(null),u=_(""),s=_(""),c=_(""),m=_(!0),y=_(!1);return T(r,(d,o)=>{if(d){let n=i.productList.find(v=>v.product_id===d);l.item.product_id=r,l.item.quantity=1,l.item.unit_price=n.selling_price,l.item.total_price=n.selling_price,u.value=1,c.value=n.selling_price,s.value=n.selling_price,l.updateProductData()}}),T(u,d=>{if(d){let o=i.productList.find(v=>v.product_id===r.value);if(d>o.available_qty)m.value=!1,l.order.errors.push({error_id:r.value,message:`Product ${o.name} has no enough quantity`});else{m.value=!0;let v=l.order.errors.findIndex(F=>F.error_id==o.product_id);l.order.errors.splice(v,1)}l.item.quantity=d;let n=l.item.quantity*l.item.unit_price;l.item.total_price=n,l.updateProductData(),c.value=n}}),T(s,d=>{if(d){let o=i.productList.find(n=>n.product_id===r.value);if(d<o.cost)y.value=!0,l.order.warnings.find(v=>v.error_id==o.product_id)||l.order.warnings.push({error_id:r.value,message:`Product ${o.name} has no enough quantity`});else{y.value=!1;let n=l.order.warnings.findIndex(v=>v.error_id==o.product_id);l.order.warnings.splice(n,1)}l.item.unit_price=d,l.item.total_price=l.item.quantity*l.item.unit_price,l.updateProductData(),c.value=l.item.total_price}}),T(c,d=>{d&&(l.item.unit_price=d/l.item.quantity,l.item.total_price=d,s.value=d/l.item.quantity,l.updateProductData())}),(d,o)=>(V(),C(g,null,{default:t(()=>[e(p,{cols:"12",lg:"3"},{default:t(()=>[e(A,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=n=>r.value=n),items:a(i).getProductsSelect,class:"centered-input",label:d.$t("product"),variant:"underlined",onUpdate:o[1]||(o[1]=n=>d.alert("Hello"))},null,8,["modelValue","items","label"])]),_:1}),e(p,{cols:"12",lg:"3"},{default:t(()=>[e(b,{modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=n=>u.value=n),label:d.$t("quantity"),placeholder:"Quantity",variant:"underlined",class:P(["centered-input",{"text-error":!m.value}]),color:m.value?"primary":"error"},null,8,["modelValue","label","class","color"])]),_:1}),e(p,{cols:"12",lg:"3"},{default:t(()=>[e(b,{modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=n=>s.value=n),label:d.$t("price"),variant:"underlined",class:P({"text-warning":y.value}),color:y.value?"warning":"primary"},null,8,["modelValue","label","class","color"])]),_:1}),e(p,{cols:"12",lg:"3"},{default:t(()=>[e(b,{modelValue:c.value,"onUpdate:modelValue":o[4]||(o[4]=n=>c.value=n),label:d.$t("subtotal"),variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}))}},oe={__name:"OrderItem",props:["tab"],setup(U){const i=U.tab,r=D();return(u,s)=>(V(),C($,null,{default:t(()=>[(V(!0),I(S,null,N(a(r).orders[a(i)].items,(c,m)=>(V(),C(re,{key:m,item:m,tab:a(i),onClick:y=>a(r).selectedItems=m},null,8,["item","tab","onClick"]))),128))]),_:1}))}};const de={class:"text-center"},ue={class:"text-center"},ne={class:"text-center"},se={class:"text-center"},ie={class:"text-center"},me={class:"text-center"},pe={class:"text-center"},ce={__name:"Subtotal",setup(U){const l=D();return(i,r)=>(V(),C(g,{class:"pa-x ma-x"},{default:t(()=>[e(p,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"},{default:t(()=>[e(L,null,{default:t(()=>[f("tbody",null,[f("tr",null,[f("td",de,[e(b,{modelValue:a(l).order.subtotal,"onUpdate:modelValue":r[0]||(r[0]=u=>a(l).order.subtotal=u),type:"number",variant:"underlined",class:"centered-input",label:i.$t("subtotal"),readonly:""},null,8,["modelValue","label"])]),f("td",ue,[e(b,{modelValue:a(l).order.labour,"onUpdate:modelValue":r[1]||(r[1]=u=>a(l).order.labour=u),onKeyup:r[2]||(r[2]=u=>a(l).updateProductData()),type:"number",variant:"underlined",class:"centered-input",label:i.$t("labour")},null,8,["modelValue","label"])]),f("td",ne,[e(b,{modelValue:a(l).order.discount,"onUpdate:modelValue":r[3]||(r[3]=u=>a(l).order.discount=u),onKeyup:r[4]||(r[4]=u=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:i.$t("discount")},null,8,["modelValue","label"])]),f("td",se,[e(b,{modelValue:a(l).order.collection,"onUpdate:modelValue":r[5]||(r[5]=u=>a(l).order.collection=u),onKeyup:r[6]||(r[6]=u=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:i.$t("collection")},null,8,["modelValue","label"])])])])]),_:1})]),_:1}),e(p,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e(L,null,{default:t(()=>[f("tbody",null,[f("tr",null,[f("td",null,x(i.$t("total")),1),f("td",ie,[e(b,{modelValue:a(l).order.total,"onUpdate:modelValue":r[7]||(r[7]=u=>a(l).order.total=u),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])]),f("tr",null,[f("td",null,x(i.$t("pay")),1),f("td",me,[e(b,{modelValue:a(l).order.pay,"onUpdate:modelValue":r[8]||(r[8]=u=>a(l).order.pay=u),onKeyup:r[9]||(r[9]=u=>a(l).updateBalance()),type:"number",placeholder:"Pay",variant:"solo-filled",class:"centered-input"},null,8,["modelValue"])])]),f("tr",null,[f("td",null,x(i.$t("balance")),1),f("td",pe,[e(b,{modelValue:a(l).order.balance,"onUpdate:modelValue":r[10]||(r[10]=u=>a(l).order.balance=u),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])])])]),_:1})]),_:1})]),_:1}))}},fe=W(ce,[["__scopeId","data-v-e36ea5ee"]]),be={__name:"CreateOrder",props:["index"],setup(U){const l=U;let i=E();_(),_(!1),_();let r=ee().format("YYYY-MM-DD");_(r);const u=l.index,s=_([]);let c=_("");H(async()=>{let d=await X.get(Z.getCustomer);s.value=d.data.data.map(o=>({title:o.name+"-"+o.village,value:o.customer_id}))});const m=D(),y=j(()=>{let d="bg-success";return m.order.warnings.length&&(d="bg-warning"),m.order.errors.length&&(d="bg-error"),d});return(d,o)=>(V(),C(g,null,{default:t(()=>[e(p,{md:"6",lg:"12",cols:"12"},{default:t(()=>[e(G,null,{default:t(()=>[e(g,{"no-gutters":""},{default:t(()=>[e(p,{cols:"12",sm:"8",md:"12",lg:"6",order:"2","order-lg":"1"},{default:t(()=>[e($,null,{default:t(()=>[e(w,null,{default:t(()=>[k(x(d.$t("customer")),1)]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(g,null,{default:t(()=>[e(p,{cols:"12",md:"6"},{default:t(()=>[e(A,{modelValue:a(m).order.customer_id,"onUpdate:modelValue":o[0]||(o[0]=n=>a(m).order.customer_id=n),items:s.value,label:d.$t("customer"),placeholder:"Customer Name"},null,8,["modelValue","items","label"])]),_:1}),e(p,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:a(c),"onUpdate:modelValue":o[1]||(o[1]=n=>J(c)?c.value=n:c=n),label:d.$t("contact_no"),placeholder:"Contact No"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,{cols:"12",sm:"4",md:"12",lg:"6",order:"1","order-lg":"2"},{default:t(()=>[e($,null,{default:t(()=>[e(w,null,{default:t(()=>[k("Order")]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(g,null,{default:t(()=>[e(p,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:a(m).order.order_code,"onUpdate:modelValue":o[2]||(o[2]=n=>a(m).order.order_code=n),label:d.$t("order_no"),placeholder:"Order No"},null,8,["modelValue","label"])]),_:1}),e(p,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:a(m).order.order_date,"onUpdate:modelValue":o[3]||(o[3]=n=>a(m).order.order_date=n),label:d.$t("order_date"),placeholder:"Order Date",type:"date"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(w,null,{default:t(()=>[k("Items")]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(K)]),_:1}),e(oe,{tab:a(u)},null,8,["tab"]),e($,null,{default:t(()=>[e(O,{block:"",onClick:o[4]||(o[4]=n=>a(m).addProductItem())},{default:t(()=>[e(B,{size:"2rem",icon:"material-symbols:add-circle-outline-rounded"})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(fe)]),_:1}),Q(e($,null,{default:t(()=>[e(g,{class:"pa-x ma-x"},{default:t(()=>[e(p,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"}),e(p,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e(g,null,{default:t(()=>[e(p,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(O,null,{default:t(()=>[k(x(d.$t("save")),1)]),_:1})]),_:1}),e(p,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(O,{class:P(a(y)),onClick:o[5]||(o[5]=n=>a(m).payment())},{default:t(()=>[k(x(d.$t("payment")),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[h,a(i).can("sales-order-create")]])]),_:1})]),_:1})]),_:1}))}},_e={__name:"sells-order",setup(U){const l=D();_("Hello");const i=l.orders;return(r,u)=>(V(),I("div",null,[e(le,{modelValue:a(l).activeTab,"onUpdate:modelValue":u[1]||(u[1]=s=>a(l).activeTab=s),"show-arrows":""},{default:t(()=>[(V(!0),I(S,null,N(a(i),(s,c)=>(V(),C(z,{key:s.name,value:s.tab,onClick:m=>a(l).selectTab(c)},{default:t(()=>[e(B,{size:"20",start:"",icon:"lucide:user-round"}),k(" "+x(s.title),1)]),_:2},1032,["value","onClick"]))),128)),e(z,{value:"",onClick:u[0]||(u[0]=s=>a(l).addTab())},{default:t(()=>[e(B,{size:"20",start:"",icon:"iconoir:new-tab"})]),_:1})]),_:1},8,["modelValue"]),e(K),e(ae,{modelValue:a(l).activeTab,"onUpdate:modelValue":u[2]||(u[2]=s=>a(l).activeTab=s),class:"mt-5 disable-tab-transition",touch:!1},{default:t(()=>[(V(!0),I(S,null,N(a(i),(s,c)=>(V(),C(te,{key:s.tab,value:s.tab},{default:t(()=>[e(be,{items:s.items,index:c},null,8,["items","index"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]))}};typeof Y=="function"&&Y(_e);export{_e as default};
