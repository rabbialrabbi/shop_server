import{aZ as F,bg as W,U as V,ad as I,o as g,W as k,w as t,a as e,e as f,i as a,a0 as v,bz as z,$,c as P,F as N,a4 as B,bh as U,bi as H,a3 as Y,b as _,t as x,aY as E,a$ as X,b3 as Z,b4 as j,g as G,a_ as J,X as Q,bl as q,k as T,Y as O,bw as h,T as S,_ as M,l as L,as as ee,az as le,m as K}from"./index.b5420dcf.js";import{u as D}from"./sellsOrders.3c0040a5.js";import{V as R}from"./VAutocomplete.1333a986.js";import{h as te}from"./moment.9709ab41.js";import{V as A,a as ae,b as oe,c as re}from"./VWindowItem.54a4c8cd.js";import"./moment.6005d801.js";import"./report.3d39650f.js";import"./VSelect.f7a3c048.js";import"./VCheckboxBtn.fdfea072.js";const de={__name:"ItemInput",setup(w){const l=D(),m=F();W(l);const o=V(null),r=V(""),i=V(""),b=V(""),p=V(!0),C=V(!1);return I(o,(u,d)=>{if(u){let n=m.productList.find(s=>s.product_id===u);l.item.product_id=o,l.item.quantity=1,l.item.unit_price=n.selling_price,l.item.total_price=n.selling_price,r.value=1,b.value=n.selling_price,i.value=n.selling_price,l.updateProductData()}}),I(r,u=>{if(u){let d=m.productList.find(s=>s.product_id===o.value);if(u>d.available_qty)p.value=!1,l.order.errors.push({error_id:o.value,message:`Product ${d.name} has no enough quantity`});else{p.value=!0;let s=l.order.errors.findIndex(c=>c.error_id==d.product_id);l.order.errors.splice(s,1)}l.item.quantity=u;let n=l.item.quantity*l.item.unit_price;l.item.total_price=n,l.updateProductData(),b.value=n}}),I(i,u=>{if(u){let d=m.productList.find(n=>n.product_id===o.value);if(u<d.cost)C.value=!0,l.order.warnings.find(s=>s.error_id==d.product_id)||l.order.warnings.push({error_id:o.value,message:`Product ${d.name} has no enough quantity`});else{C.value=!1;let n=l.order.warnings.findIndex(s=>s.error_id==d.product_id);l.order.warnings.splice(n,1)}l.item.unit_price=u,l.item.total_price=l.item.quantity*l.item.unit_price,l.updateProductData(),b.value=l.item.total_price}}),I(b,u=>{u&&(l.item.unit_price=u/l.item.quantity,l.item.total_price=u,i.value=u/l.item.quantity,l.updateProductData())}),(u,d)=>(g(),k($,null,{default:t(()=>[e(f,{cols:"12",lg:"3"},{default:t(()=>[e(R,{modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=n=>o.value=n),items:a(m).getProductsSelect,class:"centered-input",label:u.$t("product"),variant:"underlined",onUpdate:d[1]||(d[1]=n=>u.alert("Hello"))},null,8,["modelValue","items","label"])]),_:1}),e(f,{cols:"12",lg:"3"},{default:t(()=>[e(v,{modelValue:r.value,"onUpdate:modelValue":d[2]||(d[2]=n=>r.value=n),label:u.$t("quantity"),placeholder:"Quantity",variant:"underlined",class:z(["centered-input",{"text-error":!p.value}]),color:p.value?"primary":"error"},null,8,["modelValue","label","class","color"])]),_:1}),e(f,{cols:"12",lg:"3"},{default:t(()=>[e(v,{modelValue:i.value,"onUpdate:modelValue":d[3]||(d[3]=n=>i.value=n),label:u.$t("price"),variant:"underlined",class:z({"text-warning":C.value}),color:C.value?"warning":"primary"},null,8,["modelValue","label","class","color"])]),_:1}),e(f,{cols:"12",lg:"3"},{default:t(()=>[e(v,{modelValue:b.value,"onUpdate:modelValue":d[4]||(d[4]=n=>b.value=n),label:u.$t("subtotal"),variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}))}},ue={__name:"OrderItem",props:["tab"],setup(w){const m=w.tab,o=D();return(r,i)=>(g(),k(U,null,{default:t(()=>[(g(!0),P(N,null,B(a(o).orders[a(m)].items,(b,p)=>(g(),k(de,{key:p,item:p,tab:a(m),onClick:C=>a(o).selectedItems=p},null,8,["item","tab","onClick"]))),128))]),_:1}))}};const ne={class:"text-center"},se={class:"text-center"},ie={class:"text-center"},me={class:"text-center"},pe={class:"text-center"},ce={class:"text-center"},fe={class:"text-center"},be={__name:"Subtotal",setup(w){const l=D();return(m,o)=>(g(),k($,{class:"pa-x ma-x"},{default:t(()=>[e(f,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"},{default:t(()=>[e(Y,null,{default:t(()=>[_("tbody",null,[_("tr",null,[_("td",ne,[e(v,{modelValue:a(l).order.subtotal,"onUpdate:modelValue":o[0]||(o[0]=r=>a(l).order.subtotal=r),type:"number",variant:"underlined",class:"centered-input",label:m.$t("subtotal"),readonly:""},null,8,["modelValue","label"])]),_("td",se,[e(v,{modelValue:a(l).order.labour,"onUpdate:modelValue":o[1]||(o[1]=r=>a(l).order.labour=r),onKeyup:o[2]||(o[2]=r=>a(l).updateProductData()),type:"number",variant:"underlined",class:"centered-input",label:m.$t("labour")},null,8,["modelValue","label"])]),_("td",ie,[e(v,{modelValue:a(l).order.discount,"onUpdate:modelValue":o[3]||(o[3]=r=>a(l).order.discount=r),onKeyup:o[4]||(o[4]=r=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:m.$t("discount")},null,8,["modelValue","label"])]),_("td",me,[e(v,{modelValue:a(l).order.collection,"onUpdate:modelValue":o[5]||(o[5]=r=>a(l).order.collection=r),onKeyup:o[6]||(o[6]=r=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:m.$t("collection")},null,8,["modelValue","label"])])])])]),_:1})]),_:1}),e(f,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e(Y,null,{default:t(()=>[_("tbody",null,[_("tr",null,[_("td",null,x(m.$t("total")),1),_("td",pe,[e(v,{modelValue:a(l).order.total,"onUpdate:modelValue":o[7]||(o[7]=r=>a(l).order.total=r),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])]),_("tr",null,[_("td",null,x(m.$t("pay")),1),_("td",ce,[e(v,{modelValue:a(l).order.pay,"onUpdate:modelValue":o[8]||(o[8]=r=>a(l).order.pay=r),onKeyup:o[9]||(o[9]=r=>a(l).updateBalance()),type:"number",placeholder:"Pay",variant:"solo-filled",class:"centered-input"},null,8,["modelValue"])])]),_("tr",null,[_("td",null,x(m.$t("balance")),1),_("td",fe,[e(v,{modelValue:a(l).order.balance,"onUpdate:modelValue":o[10]||(o[10]=r=>a(l).order.balance=r),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])])])]),_:1})]),_:1})]),_:1}))}},_e=H(be,[["__scopeId","data-v-e36ea5ee"]]),ve={__name:"CreateOrder",props:["index"],setup(w){const l=w;let m=E();V(),V(!1),V();let o=te().format("YYYY-MM-DD");V(o);const r=l.index,i=V([]);let b=V("");X(async()=>{let s=await Z.get(j.getCustomer);i.value=s.data.data.map(c=>({title:c.name+"-"+c.village,value:c.customer_id}))});const p=D(),C=G(()=>{let s="bg-success";return p.order.warnings.length&&(s="bg-warning"),p.order.errors.length&&(s="bg-error"),s}),u=F(),d=J();async function n(){await u.updateProductList(),await d.updateCategoryList(),await d.updateProductTypeList(),await d.updateUnitTypeList()}return(s,c)=>(g(),k($,null,{default:t(()=>[e(f,{md:"6",lg:"12",cols:"12"},{default:t(()=>[e(Q,null,{default:t(()=>[e($,{"no-gutters":""},{default:t(()=>[e(f,{cols:"12",sm:"8",md:"12",lg:"6",order:"2","order-lg":"1"},{default:t(()=>[e(U,null,{default:t(()=>[e(q,null,{default:t(()=>[T(x(s.$t("customer")),1)]),_:1})]),_:1}),e(O,null,{default:t(()=>[e($,null,{default:t(()=>[e(f,{cols:"12",md:"6"},{default:t(()=>[e(R,{modelValue:a(p).order.customer_id,"onUpdate:modelValue":c[0]||(c[0]=y=>a(p).order.customer_id=y),items:i.value,label:s.$t("customer"),placeholder:"Customer Name"},null,8,["modelValue","items","label"])]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:a(b),"onUpdate:modelValue":c[1]||(c[1]=y=>h(b)?b.value=y:b=y),label:s.$t("contact_no"),placeholder:"Contact No"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",sm:"4",md:"12",lg:"6",order:"1","order-lg":"2"},{default:t(()=>[e(U,null,{default:t(()=>[e(q,null,{default:t(()=>[T("Order")]),_:1})]),_:1}),e(O,null,{default:t(()=>[e($,null,{default:t(()=>[e(f,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:a(p).order.order_code,"onUpdate:modelValue":c[2]||(c[2]=y=>a(p).order.order_code=y),label:s.$t("order_no"),placeholder:"Order No"},null,8,["modelValue","label"])]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(v,{modelValue:a(p).order.order_date,"onUpdate:modelValue":c[3]||(c[3]=y=>a(p).order.order_date=y),label:s.$t("order_date"),placeholder:"Order Date",type:"date"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(q,null,{default:t(()=>[T(" Items "),e(S,{onClick:c[4]||(c[4]=y=>n()),size:"1.5rem",icon:"zondicons:reload"})]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(M)]),_:1}),e(ue,{tab:a(r)},null,8,["tab"]),e(U,null,{default:t(()=>[e(L,{block:"",onClick:c[5]||(c[5]=y=>a(p).addProductItem())},{default:t(()=>[e(S,{size:"2rem",icon:"material-symbols:add-circle-outline-rounded"})]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(_e)]),_:1}),ee(e(U,null,{default:t(()=>[e($,{class:"pa-x ma-x"},{default:t(()=>[e(f,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"}),e(f,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e($,null,{default:t(()=>[e(f,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(L,null,{default:t(()=>[T(x(s.$t("save")),1)]),_:1})]),_:1}),e(f,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(L,{class:z(a(C)),onClick:c[6]||(c[6]=y=>a(p).payment())},{default:t(()=>[T(x(s.$t("payment")),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[le,a(m).can("sales-order-create")]])]),_:1})]),_:1})]),_:1}))}},Ve={__name:"sells-order",setup(w){const l=D();V("Hello");const m=l.orders;return(o,r)=>(g(),P("div",null,[e(ae,{modelValue:a(l).activeTab,"onUpdate:modelValue":r[1]||(r[1]=i=>a(l).activeTab=i),"show-arrows":""},{default:t(()=>[(g(!0),P(N,null,B(a(m),(i,b)=>(g(),k(A,{key:i.name,value:i.tab,onClick:p=>a(l).selectTab(b)},{default:t(()=>[e(S,{size:"20",start:"",icon:"lucide:user-round"}),T(" "+x(i.title),1)]),_:2},1032,["value","onClick"]))),128)),e(A,{value:"",onClick:r[0]||(r[0]=i=>a(l).addTab())},{default:t(()=>[e(S,{size:"20",start:"",icon:"iconoir:new-tab"})]),_:1})]),_:1},8,["modelValue"]),e(M),e(re,{modelValue:a(l).activeTab,"onUpdate:modelValue":r[2]||(r[2]=i=>a(l).activeTab=i),class:"mt-5 disable-tab-transition",touch:!1},{default:t(()=>[(g(!0),P(N,null,B(a(m),(i,b)=>(g(),k(oe,{key:i.tab,value:i.tab},{default:t(()=>[e(ve,{items:i.items,index:b},null,8,["items","index"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]))}};typeof K=="function"&&K(Ve);export{Ve as default};
