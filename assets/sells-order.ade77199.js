import{aZ as R,bg as W,U as b,ad as I,o as V,W as U,w as t,a as e,e as c,i as a,a0 as f,bE as w,$ as g,c as S,F as O,a4 as N,bh as C,bi as E,a3 as L,b as p,bj as H,bk as j,aY as Q,a$ as X,b3 as Z,b4 as G,g as J,X as h,bl as T,k,Y as $,bC as Y,_ as A,l as P,T as q,as as ee,az as le,t as te,m as z}from"./index.49b3a9ac.js";import{u as D}from"./sellsOrders.984b6676.js";import{V as F}from"./VAutocomplete.9ed7f107.js";import{h as ae}from"./moment.9709ab41.js";import{V as K,a as oe,b as re,c as de}from"./VWindowItem.50b03732.js";import"./report.fa395c02.js";import"./VSelect.17fce6d0.js";import"./VCheckboxBtn.cea21357.js";const ue={__name:"ItemInput",setup(v){const l=D(),_=R();W(l);const o=b(""),u=b(""),n=b(""),i=b(""),m=b(!0),x=b(!1);return I(o,(s,r)=>{if(s){let d=_.productList.find(y=>y.product_id===s);l.item.product_id=o,l.item.quantity=1,l.item.unit_price=d.selling_price,l.item.total_price=d.selling_price,u.value=1,i.value=d.selling_price,n.value=d.selling_price,l.updateProductData()}}),I(u,s=>{if(s){let r=_.productList.find(y=>y.product_id===o.value);if(s>r.available_qty)m.value=!1,l.order.errors.push({error_id:o.value,message:`Product ${r.name} has no enough quantity`});else{m.value=!0;let y=l.order.errors.findIndex(M=>M.error_id==r.product_id);l.order.errors.splice(y,1)}l.item.quantity=s;let d=l.item.quantity*l.item.unit_price;l.item.total_price=d,l.updateProductData(),i.value=d}}),I(n,s=>{if(s){let r=_.productList.find(d=>d.product_id===o.value);if(s<r.cost)x.value=!0,l.order.warnings.find(y=>y.error_id==r.product_id)||l.order.warnings.push({error_id:o.value,message:`Product ${r.name} has no enough quantity`});else{x.value=!1;let d=l.order.warnings.findIndex(y=>y.error_id==r.product_id);l.order.warnings.splice(d,1)}l.item.unit_price=s,l.item.total_price=l.item.quantity*l.item.unit_price,l.updateProductData(),i.value=l.item.total_price}}),I(i,s=>{s&&(l.item.unit_price=s/l.item.quantity,l.item.total_price=s,n.value=s/l.item.quantity,l.updateProductData())}),(s,r)=>(V(),U(g,null,{default:t(()=>[e(c,{cols:"12",lg:"3"},{default:t(()=>[e(F,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=d=>o.value=d),items:a(_).getProductsSelect,class:"centered-input",label:"Product",variant:"underlined",onUpdate:r[1]||(r[1]=d=>s.alert("Hello"))},null,8,["modelValue","items"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:t(()=>[e(f,{modelValue:u.value,"onUpdate:modelValue":r[2]||(r[2]=d=>u.value=d),label:"Quantity",placeholder:"Quantity",variant:"underlined",class:w(["centered-input",{"text-error":!m.value}]),color:m.value?"primary":"error"},null,8,["modelValue","class","color"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:t(()=>[e(f,{modelValue:n.value,"onUpdate:modelValue":r[3]||(r[3]=d=>n.value=d),label:"Price",variant:"underlined",class:w({"text-warning":x.value}),color:x.value?"warning":"primary"},null,8,["modelValue","class","color"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:t(()=>[e(f,{modelValue:i.value,"onUpdate:modelValue":r[4]||(r[4]=d=>i.value=d),label:"Subtotal",variant:"underlined"},null,8,["modelValue"])]),_:1})]),_:1}))}},se={__name:"OrderItem",props:["tab"],setup(v){const _=v.tab,o=D();return(u,n)=>(V(),U(C,null,{default:t(()=>[(V(!0),S(O,null,N(a(o).orders[a(_)].items,(i,m)=>(V(),U(ue,{key:m,item:m,tab:a(_),onClick:x=>a(o).selectedItems=m},null,8,["item","tab","onClick"]))),128))]),_:1}))}};const B=v=>(H("data-v-f03124c8"),v=v(),j(),v),ne={class:"text-center"},ie={class:"text-center"},me={class:"text-center"},ce={class:"text-center"},pe=B(()=>p("td",null,"Total",-1)),_e={class:"text-center"},fe=B(()=>p("td",null,"Pay",-1)),be={class:"text-center"},Ve=B(()=>p("td",null,"Balance",-1)),ve={class:"text-center"},ye={__name:"Subtotal",setup(v){const l=D();return(_,o)=>(V(),U(g,{class:"pa-x ma-x"},{default:t(()=>[e(c,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"},{default:t(()=>[e(L,null,{default:t(()=>[p("tbody",null,[p("tr",null,[p("td",ne,[e(f,{modelValue:a(l).order.subtotal,"onUpdate:modelValue":o[0]||(o[0]=u=>a(l).order.subtotal=u),type:"number",variant:"underlined",class:"centered-input",label:"Subtotal",readonly:""},null,8,["modelValue"])]),p("td",ie,[e(f,{modelValue:a(l).order.labour,"onUpdate:modelValue":o[1]||(o[1]=u=>a(l).order.labour=u),onKeyup:o[2]||(o[2]=u=>a(l).updateProductData()),type:"number",variant:"underlined",class:"centered-input",label:"Labour"},null,8,["modelValue"])]),p("td",me,[e(f,{modelValue:a(l).order.discount,"onUpdate:modelValue":o[3]||(o[3]=u=>a(l).order.discount=u),onKeyup:o[4]||(o[4]=u=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:"Discount"},null,8,["modelValue"])]),p("td",ce,[e(f,{modelValue:a(l).order.collection,"onUpdate:modelValue":o[5]||(o[5]=u=>a(l).order.collection=u),onKeyup:o[6]||(o[6]=u=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:"Collection"},null,8,["modelValue"])])])])]),_:1})]),_:1}),e(c,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e(L,null,{default:t(()=>[p("tbody",null,[p("tr",null,[pe,p("td",_e,[e(f,{modelValue:a(l).order.total,"onUpdate:modelValue":o[7]||(o[7]=u=>a(l).order.total=u),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])]),p("tr",null,[fe,p("td",be,[e(f,{modelValue:a(l).order.pay,"onUpdate:modelValue":o[8]||(o[8]=u=>a(l).order.pay=u),onKeyup:o[9]||(o[9]=u=>a(l).updateBalance()),type:"number",placeholder:"Pay",variant:"solo-filled",class:"centered-input"},null,8,["modelValue"])])]),p("tr",null,[Ve,p("td",ve,[e(f,{modelValue:a(l).order.balance,"onUpdate:modelValue":o[10]||(o[10]=u=>a(l).order.balance=u),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])])])]),_:1})]),_:1})]),_:1}))}},ge=E(ye,[["__scopeId","data-v-f03124c8"]]),xe={__name:"CreateOrder",props:["index"],setup(v){const l=v;let _=Q();b(),b(!1),b();let o=ae().format("YYYY-MM-DD");b(o);const u=l.index,n=b([]);let i=b("");X(async()=>{let s=await Z.get(G.getCustomer);n.value=s.data.data.map(r=>({title:r.name,value:r.customer_id}))});const m=D(),x=J(()=>{let s="bg-success";return m.order.warnings.length&&(s="bg-warning"),m.order.errors.length&&(s="bg-error"),s});return(s,r)=>(V(),U(g,null,{default:t(()=>[e(c,{md:"6",lg:"12",cols:"12"},{default:t(()=>[e(h,null,{default:t(()=>[e(g,{"no-gutters":""},{default:t(()=>[e(c,{cols:"12",sm:"8",md:"12",lg:"6",order:"2","order-lg":"1"},{default:t(()=>[e(C,null,{default:t(()=>[e(T,null,{default:t(()=>[k("Customer")]),_:1})]),_:1}),e($,null,{default:t(()=>[e(g,null,{default:t(()=>[e(c,{cols:"12",md:"6"},{default:t(()=>[e(F,{modelValue:a(m).order.customer_id,"onUpdate:modelValue":r[0]||(r[0]=d=>a(m).order.customer_id=d),items:n.value,label:"Customer Name",placeholder:"Customer Name"},null,8,["modelValue","items"])]),_:1}),e(c,{cols:"12",md:"6"},{default:t(()=>[e(f,{modelValue:a(i),"onUpdate:modelValue":r[1]||(r[1]=d=>Y(i)?i.value=d:i=d),label:"Contact No",placeholder:"Contact No"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",sm:"4",md:"12",lg:"6",order:"1","order-lg":"2"},{default:t(()=>[e(C,null,{default:t(()=>[e(T,null,{default:t(()=>[k("Order")]),_:1})]),_:1}),e($,null,{default:t(()=>[e(g,null,{default:t(()=>[e(c,{cols:"12",md:"6"},{default:t(()=>[e(f,{modelValue:a(i),"onUpdate:modelValue":r[2]||(r[2]=d=>Y(i)?i.value=d:i=d),label:"Order No",placeholder:"Order No",readonly:""},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"6"},{default:t(()=>[e(f,{modelValue:a(m).order.order_date,"onUpdate:modelValue":r[3]||(r[3]=d=>a(m).order.order_date=d),label:"Order Date",placeholder:"Order Date",type:"date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(T,null,{default:t(()=>[k("Items")]),_:1})]),_:1}),e($,null,{default:t(()=>[e(A)]),_:1}),e(se,{tab:a(u)},null,8,["tab"]),e(C,null,{default:t(()=>[e(P,{block:"",onClick:r[4]||(r[4]=d=>a(m).addProductItem())},{default:t(()=>[e(q,{size:"2rem",icon:"material-symbols:add-circle-outline-rounded"})]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(ge)]),_:1}),ee(e(C,null,{default:t(()=>[e(g,{class:"pa-x ma-x"},{default:t(()=>[e(c,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"}),e(c,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e(g,null,{default:t(()=>[e(c,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(P,null,{default:t(()=>[k(" Save ")]),_:1})]),_:1}),e(c,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(P,{class:w(a(x)),onClick:r[5]||(r[5]=d=>a(m).payment())},{default:t(()=>[k(" Payment ")]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[le,a(_).can("sales-order-create")]])]),_:1})]),_:1})]),_:1}))}},Ce={__name:"sells-order",setup(v){const l=D();b("Hello");const _=l.orders;return(o,u)=>(V(),S("div",null,[e(oe,{modelValue:a(l).activeTab,"onUpdate:modelValue":u[1]||(u[1]=n=>a(l).activeTab=n),"show-arrows":""},{default:t(()=>[(V(!0),S(O,null,N(a(_),(n,i)=>(V(),U(K,{key:n.name,value:n.tab,onClick:m=>a(l).selectTab(i)},{default:t(()=>[e(q,{size:"20",start:"",icon:"lucide:user-round"}),k(" "+te(n.title),1)]),_:2},1032,["value","onClick"]))),128)),e(K,{value:"",onClick:u[0]||(u[0]=n=>a(l).addTab())},{default:t(()=>[e(q,{size:"20",start:"",icon:"iconoir:new-tab"})]),_:1})]),_:1},8,["modelValue"]),e(A),e(de,{modelValue:a(l).activeTab,"onUpdate:modelValue":u[2]||(u[2]=n=>a(l).activeTab=n),class:"mt-5 disable-tab-transition",touch:!1},{default:t(()=>[(V(!0),S(O,null,N(a(_),(n,i)=>(V(),U(re,{key:n.tab,value:n.tab},{default:t(()=>[e(xe,{items:n.items,index:i},null,8,["items","index"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]))}};typeof z=="function"&&z(Ce);export{Ce as default};
