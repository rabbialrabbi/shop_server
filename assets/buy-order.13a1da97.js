import{bg as z,b2 as D,b3 as U,aW as F,P as h,aa as P,o as f,Q as v,w as l,a as e,e as c,aZ as o,X as b,W as V,c as x,F as O,a0 as k,bi as y,bj as q,$ as N,b as m,bk as M,bl as E,aV as H,aY as R,R as j,bf as I,Y as g,S,U as Y,O as C,N as w,ap as X,aw as Z,t as G,a3 as L}from"./index.71bb308e.js";import{h as J}from"./moment.9709ab41.js";import{V as A}from"./VAutocomplete.7737ec6c.js";import{V as B,a as Q,b as ee,c as te}from"./VWindowItem.6c27eed5.js";import"./VSelect.d3481141.js";import"./VCheckboxBtn.b2e8ef07.js";const T=z("buyOrders",{state:()=>({activeTab:"tab1",selectedTab:0,selectedItems:0,totalTab:1,orders:[{title:"buyer1",icon:"mdi-account-outline",tab:"tab1",vendor_id:null,order_date:J().format("YYYY-MM-DD"),items:[{product_id:null,quantity:null,unit_price:null,total_price:null}],subtotal:0,charge:0,discount:0,collection:0,total:0,pay:0,balance:0}],status:0}),getters:{order:a=>a.orders[a.selectedTab],item:a=>a.orders[a.selectedTab].items[a.selectedItems]},actions:{setUnitType(a){this.unitType=this.createSelectData(a,"name","unit_id")},setCategoryList(a){this.categories=this.createSelectData(a,"name","category_id")},setProductTypeList(a){this.productTypes=a},async updateProductList(a){let t=await D.get(U.getProductList);this.productList=t.data.data},createSelectData(a,t,p){return a.map(r=>({title:r[t],value:r[p]}))},addProductItem(){this.selectedItems++,this.orders[this.selectedTab].items.push({product_id:null,quantity:0,unit_price:0,total_price:0})},addTab(){this.totalTab++;let a=this.totalTab;this.orders.push({title:`buyer${a}`,icon:"mdi-account-outline",tab:`tab${a}`,items:[{product_id:null,quantity:null,unit_price:null,total_price:null}],subtotal:0,charge:0,discount:0,collection:0,total:0,pay:0,balance:0})},selectTab(a){this.selectedTab=a,this.activeTab=this.orders[a].tab},updateProductData(){this.item.total_price=parseInt(this.item.unit_price)*parseInt(this.item.quantity||1);let a=0;this.order.items.forEach(t=>{a=a+t.total_price}),console.log("Hello"),this.order.subtotal=a,this.order.total=a+this.order.discount,this.order.balance=this.order.total-this.order.pay,this.order.total=this.order.subtotal+this.order.charge+this.order.collection-this.order.discount,this.order.balance=this.order.total-this.order.pay},async payment(){let a=this;await D.post(U.buyOrderStore,this.order).then(function(t){t.status&&a.resetOrder()}).catch(function(t){})},resetOrder(){this.orders[this.selectedTab].items=[];let a=this;setTimeout(()=>{a.addProductItem()},100),this.orders[this.selectedTab].subtotal=0,this.orders[this.selectedTab].discount=0,this.orders[this.selectedTab].total=0,this.orders[this.selectedTab].pay=0,this.orders[this.selectedTab].balance=0}}}),le={__name:"ItemInput",setup(a){const t=T(),p=F(),r=h(""),d=h(""),u=h(""),i=h("");return P(r,(s,n)=>{if(s){let _=p.productList.find(W=>W.product_id===s);t.item.product_id=r,t.item.unit_price=_.selling_price,d.value=1,u.value=_.selling_price,i.value=_.selling_price,t.updateProductData()}}),P(d,s=>{s&&(t.item.quantity=s,t.updateProductData(),i.value=t.item.total_price)}),P(u,s=>{s&&(t.item.unit_price=s,t.updateProductData(),i.value=t.item.total_price)}),(s,n)=>(f(),v(V,null,{default:l(()=>[e(c,{cols:"12",lg:"3"},{default:l(()=>[e(A,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=_=>r.value=_),items:o(p).getProductsSelect,label:"Product",variant:"underlined"},null,8,["modelValue","items"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:l(()=>[e(b,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=_=>d.value=_),label:"Unit Amount",placeholder:"Unit Amount",variant:"underlined"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:l(()=>[e(b,{modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=_=>u.value=_),label:"Price",variant:"underlined"},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:l(()=>[e(b,{modelValue:i.value,"onUpdate:modelValue":n[3]||(n[3]=_=>i.value=_),label:"Subtotal",variant:"underlined",readonly:""},null,8,["modelValue"])]),_:1})]),_:1}))}},ae={__name:"OrderItem",props:["tab"],setup(a){const p=a.tab,r=T();return(d,u)=>(f(),v(y,null,{default:l(()=>[(f(!0),x(O,null,k(o(r).orders[o(p)].items,(i,s)=>(f(),v(le,{key:s,item:s,tab:o(p),onClick:n=>o(r).selectedItems=s},null,8,["item","tab","onClick"]))),128))]),_:1}))}};const $=a=>(M("data-v-cc1a7bb0"),a=a(),E(),a),oe={class:"text-center"},de={class:"text-center"},re={class:"text-center"},se={class:"text-center"},ue=$(()=>m("td",null,"Total",-1)),ne={class:"text-center"},ie=$(()=>m("td",null,"Pay",-1)),ce={class:"text-center"},me=$(()=>m("td",null,"Balance",-1)),pe={class:"text-center"},be={__name:"Subtotal",setup(a){const t=T();return(p,r)=>(f(),v(V,{class:"pa-x ma-x"},{default:l(()=>[e(c,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"},{default:l(()=>[e(N,null,{default:l(()=>[m("tbody",null,[m("tr",null,[m("td",oe,[e(b,{modelValue:o(t).order.subtotal,"onUpdate:modelValue":r[0]||(r[0]=d=>o(t).order.subtotal=d),type:"number",variant:"underlined",class:"centered-input",label:"Subtotal",readonly:""},null,8,["modelValue"])]),m("td",de,[e(b,{modelValue:o(t).order.charge,"onUpdate:modelValue":r[1]||(r[1]=d=>o(t).order.charge=d),onKeyup:r[2]||(r[2]=d=>o(t).updateProductData()),type:"number",variant:"underlined",class:"centered-input",label:"Charge"},null,8,["modelValue"])]),m("td",re,[e(b,{modelValue:o(t).order.discount,"onUpdate:modelValue":r[3]||(r[3]=d=>o(t).order.discount=d),onKeyup:r[4]||(r[4]=d=>o(t).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:"Discount"},null,8,["modelValue"])]),m("td",se,[e(b,{modelValue:o(t).order.collection,"onUpdate:modelValue":r[5]||(r[5]=d=>o(t).order.collection=d),onKeyup:r[6]||(r[6]=d=>o(t).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:"Collection"},null,8,["modelValue"])])])])]),_:1})]),_:1}),e(c,{md:"6",lg:"4",cols:"12"},{default:l(()=>[e(N,null,{default:l(()=>[m("tbody",null,[m("tr",null,[ue,m("td",ne,[e(b,{modelValue:o(t).order.total,"onUpdate:modelValue":r[7]||(r[7]=d=>o(t).order.total=d),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])]),m("tr",null,[ie,m("td",ce,[e(b,{modelValue:o(t).order.pay,"onUpdate:modelValue":r[8]||(r[8]=d=>o(t).order.pay=d),onKeyup:r[9]||(r[9]=d=>o(t).updateProductData()),type:"number",placeholder:"Pay",variant:"solo-filled",class:"centered-input"},null,8,["modelValue"])])]),m("tr",null,[me,m("td",pe,[e(b,{modelValue:o(t).order.balance,"onUpdate:modelValue":r[10]||(r[10]=d=>o(t).order.balance=d),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])])])]),_:1})]),_:1})]),_:1}))}},_e=q(be,[["__scopeId","data-v-cc1a7bb0"]]),fe={__name:"CreateOrder",props:["index"],setup(a){const t=a;let p=H();const r=t.index,d=T(),u=h([]);return R(async()=>{let i=await D.get(U.getVendor);u.value=i.data.data.map(s=>({title:s.name,value:s.vendor_id}))}),(i,s)=>(f(),v(V,null,{default:l(()=>[e(c,{md:"6",lg:"12",cols:"12"},{default:l(()=>[e(j,null,{default:l(()=>[e(V,{"no-gutters":""},{default:l(()=>[e(c,{cols:"12",sm:"8",md:"12",lg:"6",order:"2","order-lg":"1"},{default:l(()=>[e(y,null,{default:l(()=>[e(I,null,{default:l(()=>[g("Buyer")]),_:1})]),_:1}),e(S,null,{default:l(()=>[e(V,null,{default:l(()=>[e(c,{cols:"12",md:"6"},{default:l(()=>[e(A,{modelValue:o(d).order.vendor_id,"onUpdate:modelValue":s[0]||(s[0]=n=>o(d).order.vendor_id=n),items:u.value,label:"Customer Name",placeholder:"Customer Name"},null,8,["modelValue","items"])]),_:1}),e(c,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:i.firstName,"onUpdate:modelValue":s[1]||(s[1]=n=>i.firstName=n),label:"Contact No",placeholder:"Contact No"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",sm:"4",md:"12",lg:"6",order:"1","order-lg":"2"},{default:l(()=>[e(y,null,{default:l(()=>[e(I,null,{default:l(()=>[g("Order")]),_:1})]),_:1}),e(S,null,{default:l(()=>[e(V,null,{default:l(()=>[e(c,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:i.firstName,"onUpdate:modelValue":s[2]||(s[2]=n=>i.firstName=n),label:"Order No",placeholder:"Order No",readonly:""},null,8,["modelValue"])]),_:1}),e(c,{cols:"12",md:"6"},{default:l(()=>[e(b,{modelValue:o(d).order.order_date,"onUpdate:modelValue":s[3]||(s[3]=n=>o(d).order.order_date=n),label:"Order Date",placeholder:"Order Date",type:"date"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(I,null,{default:l(()=>[g("Items")]),_:1})]),_:1}),e(S,null,{default:l(()=>[e(Y)]),_:1}),e(ae,{tab:o(r)},null,8,["tab"]),e(y,null,{default:l(()=>[e(C,{block:"",onClick:s[4]||(s[4]=n=>o(d).addProductItem()),class:"bg-warning"},{default:l(()=>[e(w,{size:"2rem",icon:"material-symbols:add-circle-outline-rounded"})]),_:1})]),_:1}),e(y,null,{default:l(()=>[e(_e)]),_:1}),X(e(y,null,{default:l(()=>[e(V,{class:"pa-x ma-x"},{default:l(()=>[e(c,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"}),e(c,{md:"6",lg:"4",cols:"12"},{default:l(()=>[e(V,null,{default:l(()=>[e(c,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:l(()=>[e(C,{class:"bg-warning"},{default:l(()=>[g(" Save ")]),_:1})]),_:1}),e(c,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:l(()=>[e(C,{class:"bg-success",onClick:s[5]||(s[5]=n=>o(d).payment())},{default:l(()=>[g(" Payment ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[Z,o(p).can("buy-order-create")]])]),_:1})]),_:1})]),_:1}))}};const K={__name:"buy-order",setup(a){const t=T();h("Hello");const p=t.orders;return(r,d)=>(f(),x("div",null,[e(Q,{modelValue:o(t).activeTab,"onUpdate:modelValue":d[1]||(d[1]=u=>o(t).activeTab=u),"show-arrows":""},{default:l(()=>[(f(!0),x(O,null,k(o(p),(u,i)=>(f(),v(B,{key:u.name,value:u.tab,onClick:s=>o(t).selectTab(i),color:"warning"},{default:l(()=>[e(w,{size:"20",start:"",icon:"lucide:user-round"}),g(" "+G(u.title),1)]),_:2},1032,["value","onClick"]))),128)),e(B,{value:"",onClick:d[0]||(d[0]=u=>o(t).addTab()),color:"warning"},{default:l(()=>[e(w,{size:"20",start:"",icon:"iconoir:new-tab"})]),_:1})]),_:1},8,["modelValue"]),e(Y),e(te,{modelValue:o(t).activeTab,"onUpdate:modelValue":d[2]||(d[2]=u=>o(t).activeTab=u),class:"mt-5 disable-tab-transition",touch:!1},{default:l(()=>[(f(!0),x(O,null,k(o(p),(u,i)=>(f(),v(ee,{key:u.tab,value:u.tab},{default:l(()=>[e(fe,{items:u.items,index:i},null,8,["items","index"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]))}};typeof L=="function"&&L(K);const xe=q(K,[["__scopeId","data-v-8e6ceac6"]]);export{xe as default};
