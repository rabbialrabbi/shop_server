import{aZ as R,bg as W,U as _,ad as T,o as V,W as C,w as t,a as e,e as c,i as a,a0 as b,bE as P,$ as y,c as I,F as S,a4 as N,bh as $,bi as E,a3 as L,b as f,t as x,aY as H,a$ as X,b3 as Z,b4 as j,g as G,X as J,bl as w,k,Y as q,bC as Y,_ as A,l as O,T as B,as as Q,az as h,m as z}from"./index.9fedba82.js";import{u as D}from"./sellsOrders.bdcbf1e4.js";import{V as F}from"./VAutocomplete.f22107bf.js";import{h as ee}from"./moment.9709ab41.js";import{V as K,a as le,b as te,c as ae}from"./VWindowItem.63f83de6.js";import"./report.f5f31ae4.js";import"./VSelect.804660ff.js";import"./VCheckboxBtn.34931063.js";const oe={__name:"ItemInput",setup(U){const l=D(),i=R();W(l);const o=_(null),n=_(""),s=_(""),m=_(""),p=_(!0),g=_(!1);return T(o,(d,r)=>{if(d){let u=i.productList.find(v=>v.product_id===d);l.item.product_id=o,l.item.quantity=1,l.item.unit_price=u.selling_price,l.item.total_price=u.selling_price,n.value=1,m.value=u.selling_price,s.value=u.selling_price,l.updateProductData()}}),T(n,d=>{if(d){let r=i.productList.find(v=>v.product_id===o.value);if(d>r.available_qty)p.value=!1,l.order.errors.push({error_id:o.value,message:`Product ${r.name} has no enough quantity`});else{p.value=!0;let v=l.order.errors.findIndex(M=>M.error_id==r.product_id);l.order.errors.splice(v,1)}l.item.quantity=d;let u=l.item.quantity*l.item.unit_price;l.item.total_price=u,l.updateProductData(),m.value=u}}),T(s,d=>{if(d){let r=i.productList.find(u=>u.product_id===o.value);if(d<r.cost)g.value=!0,l.order.warnings.find(v=>v.error_id==r.product_id)||l.order.warnings.push({error_id:o.value,message:`Product ${r.name} has no enough quantity`});else{g.value=!1;let u=l.order.warnings.findIndex(v=>v.error_id==r.product_id);l.order.warnings.splice(u,1)}l.item.unit_price=d,l.item.total_price=l.item.quantity*l.item.unit_price,l.updateProductData(),m.value=l.item.total_price}}),T(m,d=>{d&&(l.item.unit_price=d/l.item.quantity,l.item.total_price=d,s.value=d/l.item.quantity,l.updateProductData())}),(d,r)=>(V(),C(y,null,{default:t(()=>[e(c,{cols:"12",lg:"3"},{default:t(()=>[e(F,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=u=>o.value=u),items:a(i).getProductsSelect,class:"centered-input",label:d.$t("product"),variant:"underlined",onUpdate:r[1]||(r[1]=u=>d.alert("Hello"))},null,8,["modelValue","items","label"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:t(()=>[e(b,{modelValue:n.value,"onUpdate:modelValue":r[2]||(r[2]=u=>n.value=u),label:d.$t("quantity"),placeholder:"Quantity",variant:"underlined",class:P(["centered-input",{"text-error":!p.value}]),color:p.value?"primary":"error"},null,8,["modelValue","label","class","color"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:t(()=>[e(b,{modelValue:s.value,"onUpdate:modelValue":r[3]||(r[3]=u=>s.value=u),label:d.$t("price"),variant:"underlined",class:P({"text-warning":g.value}),color:g.value?"warning":"primary"},null,8,["modelValue","label","class","color"])]),_:1}),e(c,{cols:"12",lg:"3"},{default:t(()=>[e(b,{modelValue:m.value,"onUpdate:modelValue":r[4]||(r[4]=u=>m.value=u),label:d.$t("subtotal"),variant:"underlined"},null,8,["modelValue","label"])]),_:1})]),_:1}))}},re={__name:"OrderItem",props:["tab"],setup(U){const i=U.tab,o=D();return(n,s)=>(V(),C($,null,{default:t(()=>[(V(!0),I(S,null,N(a(o).orders[a(i)].items,(m,p)=>(V(),C(oe,{key:p,item:p,tab:a(i),onClick:g=>a(o).selectedItems=p},null,8,["item","tab","onClick"]))),128))]),_:1}))}};const de={class:"text-center"},ue={class:"text-center"},ne={class:"text-center"},se={class:"text-center"},ie={class:"text-center"},me={class:"text-center"},pe={class:"text-center"},ce={__name:"Subtotal",setup(U){const l=D();return(i,o)=>(V(),C(y,{class:"pa-x ma-x"},{default:t(()=>[e(c,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"},{default:t(()=>[e(L,null,{default:t(()=>[f("tbody",null,[f("tr",null,[f("td",de,[e(b,{modelValue:a(l).order.subtotal,"onUpdate:modelValue":o[0]||(o[0]=n=>a(l).order.subtotal=n),type:"number",variant:"underlined",class:"centered-input",label:i.$t("subtotal"),readonly:""},null,8,["modelValue","label"])]),f("td",ue,[e(b,{modelValue:a(l).order.labour,"onUpdate:modelValue":o[1]||(o[1]=n=>a(l).order.labour=n),onKeyup:o[2]||(o[2]=n=>a(l).updateProductData()),type:"number",variant:"underlined",class:"centered-input",label:i.$t("labour")},null,8,["modelValue","label"])]),f("td",ne,[e(b,{modelValue:a(l).order.discount,"onUpdate:modelValue":o[3]||(o[3]=n=>a(l).order.discount=n),onKeyup:o[4]||(o[4]=n=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:i.$t("discount")},null,8,["modelValue","label"])]),f("td",se,[e(b,{modelValue:a(l).order.collection,"onUpdate:modelValue":o[5]||(o[5]=n=>a(l).order.collection=n),onKeyup:o[6]||(o[6]=n=>a(l).updateProductData()),type:"number",class:"centered-input",variant:"underlined",label:i.$t("collection")},null,8,["modelValue","label"])])])])]),_:1})]),_:1}),e(c,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e(L,null,{default:t(()=>[f("tbody",null,[f("tr",null,[f("td",null,x(i.$t("total")),1),f("td",ie,[e(b,{modelValue:a(l).order.total,"onUpdate:modelValue":o[7]||(o[7]=n=>a(l).order.total=n),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])]),f("tr",null,[f("td",null,x(i.$t("pay")),1),f("td",me,[e(b,{modelValue:a(l).order.pay,"onUpdate:modelValue":o[8]||(o[8]=n=>a(l).order.pay=n),onKeyup:o[9]||(o[9]=n=>a(l).updateBalance()),type:"number",placeholder:"Pay",variant:"solo-filled",class:"centered-input"},null,8,["modelValue"])])]),f("tr",null,[f("td",null,x(i.$t("balance")),1),f("td",pe,[e(b,{modelValue:a(l).order.balance,"onUpdate:modelValue":o[10]||(o[10]=n=>a(l).order.balance=n),type:"number",placeholder:"Discount",variant:"solo-filled",class:"centered-input",readonly:""},null,8,["modelValue"])])])])]),_:1})]),_:1})]),_:1}))}},fe=E(ce,[["__scopeId","data-v-e36ea5ee"]]),be={__name:"CreateOrder",props:["index"],setup(U){const l=U;let i=H();_(),_(!1),_();let o=ee().format("YYYY-MM-DD");_(o);const n=l.index,s=_([]);let m=_("");X(async()=>{let d=await Z.get(j.getCustomer);s.value=d.data.data.map(r=>({title:r.name,value:r.customer_id}))});const p=D(),g=G(()=>{let d="bg-success";return p.order.warnings.length&&(d="bg-warning"),p.order.errors.length&&(d="bg-error"),d});return(d,r)=>(V(),C(y,null,{default:t(()=>[e(c,{md:"6",lg:"12",cols:"12"},{default:t(()=>[e(J,null,{default:t(()=>[e(y,{"no-gutters":""},{default:t(()=>[e(c,{cols:"12",sm:"8",md:"12",lg:"6",order:"2","order-lg":"1"},{default:t(()=>[e($,null,{default:t(()=>[e(w,null,{default:t(()=>[k(x(d.$t("customer")),1)]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(y,null,{default:t(()=>[e(c,{cols:"12",md:"6"},{default:t(()=>[e(F,{modelValue:a(p).order.customer_id,"onUpdate:modelValue":r[0]||(r[0]=u=>a(p).order.customer_id=u),items:s.value,label:d.$t("customer"),placeholder:"Customer Name"},null,8,["modelValue","items","label"])]),_:1}),e(c,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:a(m),"onUpdate:modelValue":r[1]||(r[1]=u=>Y(m)?m.value=u:m=u),label:d.$t("contact_no"),placeholder:"Contact No"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1}),e(c,{cols:"12",sm:"4",md:"12",lg:"6",order:"1","order-lg":"2"},{default:t(()=>[e($,null,{default:t(()=>[e(w,null,{default:t(()=>[k("Order")]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(y,null,{default:t(()=>[e(c,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:a(m),"onUpdate:modelValue":r[2]||(r[2]=u=>Y(m)?m.value=u:m=u),label:d.$t("order_no"),placeholder:"Order No",readonly:""},null,8,["modelValue","label"])]),_:1}),e(c,{cols:"12",md:"6"},{default:t(()=>[e(b,{modelValue:a(p).order.order_date,"onUpdate:modelValue":r[3]||(r[3]=u=>a(p).order.order_date=u),label:d.$t("order_date"),placeholder:"Order Date",type:"date"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(w,null,{default:t(()=>[k("Items")]),_:1})]),_:1}),e(q,null,{default:t(()=>[e(A)]),_:1}),e(re,{tab:a(n)},null,8,["tab"]),e($,null,{default:t(()=>[e(O,{block:"",onClick:r[4]||(r[4]=u=>a(p).addProductItem())},{default:t(()=>[e(B,{size:"2rem",icon:"material-symbols:add-circle-outline-rounded"})]),_:1})]),_:1}),e($,null,{default:t(()=>[e(fe)]),_:1}),Q(e($,null,{default:t(()=>[e(y,{class:"pa-x ma-x"},{default:t(()=>[e(c,{md:"6",lg:"8",cols:"12",class:"pa-x ma-x"}),e(c,{md:"6",lg:"4",cols:"12"},{default:t(()=>[e(y,null,{default:t(()=>[e(c,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(O,null,{default:t(()=>[k(x(d.$t("save")),1)]),_:1})]),_:1}),e(c,{md:"6",lg:"6",cols:"12",class:"text-center"},{default:t(()=>[e(O,{class:P(a(g)),onClick:r[5]||(r[5]=u=>a(p).payment())},{default:t(()=>[k(x(d.$t("payment")),1)]),_:1},8,["class"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[h,a(i).can("sales-order-create")]])]),_:1})]),_:1})]),_:1}))}},_e={__name:"sells-order",setup(U){const l=D();_("Hello");const i=l.orders;return(o,n)=>(V(),I("div",null,[e(le,{modelValue:a(l).activeTab,"onUpdate:modelValue":n[1]||(n[1]=s=>a(l).activeTab=s),"show-arrows":""},{default:t(()=>[(V(!0),I(S,null,N(a(i),(s,m)=>(V(),C(K,{key:s.name,value:s.tab,onClick:p=>a(l).selectTab(m)},{default:t(()=>[e(B,{size:"20",start:"",icon:"lucide:user-round"}),k(" "+x(s.title),1)]),_:2},1032,["value","onClick"]))),128)),e(K,{value:"",onClick:n[0]||(n[0]=s=>a(l).addTab())},{default:t(()=>[e(B,{size:"20",start:"",icon:"iconoir:new-tab"})]),_:1})]),_:1},8,["modelValue"]),e(A),e(ae,{modelValue:a(l).activeTab,"onUpdate:modelValue":n[2]||(n[2]=s=>a(l).activeTab=s),class:"mt-5 disable-tab-transition",touch:!1},{default:t(()=>[(V(!0),I(S,null,N(a(i),(s,m)=>(V(),C(te,{key:s.tab,value:s.tab},{default:t(()=>[e(be,{items:s.items,index:m},null,8,["items","index"])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]))}};typeof z=="function"&&z(_e);export{_e as default};
